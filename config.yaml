server:
  port: 8080

storage:
  type: sqlite
  sqlite:
    path: /app/data/conversations.db

apps:
  - name: playground
    frontdoor: openai
    path: /openai
    model_routing:
      prefix_providers:
        openai: openai
        anthropic: anthropic
      rewrites:
        - model_exact: claude-haiku-4.5
          provider: openai
          model: gpt-5-mini
          rewrite_response_model: true
    models:
      - id: claude-haiku-4.5
        object: model
        owned_by: gateway
      - id: claude-sonnet-alpha
        object: model
        owned_by: gateway
  - name: codex
    frontdoor: openai
    path: /codex
    enable_responses: true
    model_routing:
      fallback:
        provider: openai
        model: gpt-5-mini
  - name: claude
    frontdoor: anthropic
    path: /claude
    provider: anthropic
    shadow:
      enabled: true
      timeout: 30s
      providers:
        - name: openai
          model: gpt-5-mini
          # max_tokens_multiplier controls shadow token limits:
          #   0 or omitted = unlimited (default, recommended for reasoning models)
          #   1 = same as original request
          #   >1 = multiply original (e.g., 2 = double)

providers:
  - name: openai
    type: openai
    api_key: ${OPENAI_API_KEY}
    use_responses_api: true
    # Optional: reuse Responses threads when a metadata field is present (e.g., metadata.user_id)
    responses_thread_key_path: "metadata.user_id"
    # Persist thread state through the configured storage backend
    responses_thread_persistence: true

  - name: anthropic
    type: anthropic
    api_key: ${ANTHROPIC_API_KEY}

routing:
  rules:
    - model_prefix: "claude"
      provider: anthropic

    - model_prefix: "gpt"
      provider: openai

  default_provider: openai
